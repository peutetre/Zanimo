(function(d){typeof exports==="object"?module.exports=d():Zanimo=d()})(function(){return function(){var d=window.Q||require("q");if(!window.requestAnimationFrame)window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();var e=function(a){var b=/(\(.+?\))/g,f=/^0px$/g,e=/ /g,c=/\-([a-z])/g,g="transitionend",d="transition",h=null,i=null,
m="opacity 100ms linear 0s",r=function(a,b,e){return a+" "+b+"ms "+(e||"linear")},j={transform:""},q=function(a,b){return b.toUpperCase()},t=function(a){var b=[];a.substr(1,a.length-2).split(",").forEach(function(a){b.push(a.replace(e,"").replace(f,"0"))});return"("+b.join(",")+")"},n=function(a){return(a[0]==="-"?a.substr(1,a.length-1):a).replace(c,q)},o=function(a){return a===null||a===void 0?"":isNaN(a)?a.replace(b,t):a.toString()};"WebkitTransition"in a.body.style&&(g="webkitTransitionEnd",h=
"webkit");for(var p in j)j[p]=h?"-"+h+"-"+p:p;d=n(h?h+"-"+d:d);i=a.createElement("div");m=o(m);i.style[d]=m;i=o(i.style[d]);i===m&&(r=function(a,b,e){return a+" "+b+"ms "+(e||"linear")+" 0s"});return{t:d,transform:n(j.transform),transitionend:g,norm:n,prefix:function(a){return j[a]?j[a]:a},repr:r,normValue:o}}(window.document),c=function(a){return a&&a.nodeType?d.resolve(a):d.isPromise(a)?a.then(c):d.reject(Error("Zanimo require an HTMLElement, or a promise of an HTMLElement"))},q=function(a,b,f,
d,c){b=e.prefix(b);a.style[e.t]=a.style[e.t]?a.style[e.t]+", "+e.repr(b,d,c):e.repr(b,d,c);a.style[e.norm(b)]=f};c.transition=function(a,b,f,c,s){var g=d.defer(),l,h=function(d){l&&(clearTimeout(l),l=null);e.prefix(b);var f=[],c;for(c in a._zanimo)f.push(c);f.length===1&&f[0]===b&&(a.style[e.t]="");a.removeEventListener(e.transitionend,i);d&&delete a._zanimo[b]},i=function(f){e.norm(f.propertyName)===e.norm(e.prefix(b))&&(h(!0),g.resolve(a))};if(!a||!a.nodeType)return g.reject(Error("Zanimo transition: no DOM element!")),
g.promise;if(window.isNaN(parseInt(c,10)))return g.reject(Error("Zanimo transition: duration must be an integer!")),g.promise;a.addEventListener(e.transitionend,i);window.requestAnimationFrame(function(){q(a,b,f,c,s);l=setTimeout(function(){var c=a.style.getPropertyValue(e.prefix(b)),c=e.normValue(c),d=e.normValue(f);h(!0);c===d?g.resolve(a):g.reject(Error("Zanimo transition: "+a.id+" with "+b+" = "+d+", DOM value="+c))},c+20);a._zanimo=a._zanimo||{};a._zanimo[b]&&(a._zanimo[b].defer.reject(Error("Zanimo transition "+
a.id+" with "+b+"="+a._zanimo[b].value+" stopped by transition with "+b+"="+f)),a._zanimo[b].cb());a._zanimo[b]={cb:h,value:f,defer:g}},a);return g.promise};c.transitionf=function(a,b,f,d){return function(e){return c.transition(e,a,b,f,d)}};c.transform=function(a,b,c){var k=d.defer();if(!a||!a.nodeType)return k.reject(Error("Zanimo transform: no DOM element!")),k.promise;a._zanimo&&a._zanimo.hasOwnProperty("transform")&&(a._zanimo.transform.defer.reject(Error("Zanimo transition "+a.id+" with transform="+
a._zanimo.transform.value+" stopped by transform="+b)),a._zanimo.transform.cb());window.requestAnimationFrame(function(){a.style[e.transform]=!c?a.style[e.transform]+" "+b:b;k.resolve(a)},a);return k.promise};c.transformf=function(a,b){return function(d){return c.transform(d,a,b)}};c.f=function(a){return function(){return c(a)}};c.all=function(a){return function(b){return d.all(a.map(function(a){return a(b)})).then(function(a){a=a.filter(function(a){return d.isRejected(a)});return a.length?d.reject(a):
b})}};c._T=e;return c}()});
